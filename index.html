<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formatura Maria Valentina</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,300&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Configuração do Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['Cinzel', 'serif'],
                        sans: ['Montserrat', 'sans-serif'],
                        display: ['Cormorant Garamond', 'serif'],
                    },
                    letterSpacing: {
                        luxury: '0.3em',
                        ultra: '0.6em',
                    },
                    colors: {
                        navy: '#000814',
                        'blue-accent': '#1e3a8a',
                    },
                    animation: {
                        fadeIn: 'fadeIn 1s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            --navy: #000814;
        }
        body {
            background-color: var(--navy);
            color: rgba(255, 255, 255, 0.9);
            -webkit-font-smoothing: antialiased;
        }
        .bg-navy-gradient {
            background: radial-gradient(circle at center, #001d3d 0%, #000814 100%);
        }
        .text-shadow-premium {
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.8);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Esconder scrollbar mas permitir scroll */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-[#000814] text-white overflow-x-hidden">

    <div id="app">
        
        <!-- TELA 1: HERO E FORMULÁRIO -->
        <div id="welcome-screen">
            <div class="relative min-h-screen flex flex-col items-center justify-center text-center px-6 overflow-hidden bg-navy-gradient">
                <div class="absolute inset-0 z-0 overflow-hidden pointer-events-none">
                    <div class="absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-blue-900/10 blur-[150px] rounded-full"></div>
                    <div class="absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-blue-600/10 blur-[150px] rounded-full"></div>
                </div>

                <div class="relative z-20 max-w-6xl w-full flex flex-col items-center justify-center space-y-10 animate-fadeIn">
                    <div class="flex items-center gap-6">
                        <div class="h-[1px] w-16 bg-gradient-to-r from-transparent to-blue-500/50"></div>
                        <span class="text-blue-400 font-sans text-xs tracking-ultra uppercase font-bold">Psicologia 2026</span>
                        <div class="h-[1px] w-16 bg-gradient-to-l from-transparent to-blue-500/50"></div>
                    </div>
                    
                    <h1 class="text-5xl sm:text-7xl md:text-8xl lg:text-[9rem] font-serif text-white tracking-tighter leading-[0.9] text-shadow-premium">
                        Maria <span class="text-white block sm:inline italic font-medium">Valentina</span>
                    </h1>

                    <div class="w-56 h-40 md:w-96 md:h-64 flex items-center justify-center">
                        <img src="https://i.imgur.com/tlyqJn0.png" alt="Logo Maria Valentina" class="w-full h-full object-contain drop-shadow-[0_0_15px_rgba(59,130,246,0.5)]">
                    </div>

                    <p class="text-sm md:text-base text-blue-100/40 font-sans font-light max-w-lg mx-auto leading-relaxed italic px-4">
                        "Conheça todas as teorias, domine todas as técnicas, mas ao tocar uma alma humana, seja apenas outra alma humana"
                    </p>

                    <button onclick="document.getElementById('rsvp-section').scrollIntoView({behavior: 'smooth'})" class="group bg-blue-900 text-white px-12 py-4 rounded-full font-sans font-bold uppercase tracking-luxury text-xs hover:scale-105 transition-all shadow-2xl border border-blue-400/20 relative overflow-hidden">
                        <span class="relative z-10">Confirmar Presença</span>
                        <div class="absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    </button>
                </div>
            </div>

            <div id="rsvp-section" class="relative py-20 pb-32 px-4 flex flex-col items-center overflow-hidden bg-[#000814]">
                <form id="rsvp-form" onsubmit="handleRSVPSubmit(event)" class="w-full max-w-2xl bg-[#001d3d]/20 backdrop-blur-3xl p-8 md:p-16 rounded-[3rem] border border-blue-500/10 shadow-2xl relative">
                    <div class="text-center mb-12">
                        <p class="text-blue-400/60 font-sans text-xs uppercase tracking-ultra font-bold" id="form-title">Registro de Presença</p>
                    </div>

                    <div class="space-y-8">
                        <div class="space-y-2">
                            <label class="text-[10px] font-sans font-bold text-blue-400 uppercase tracking-luxury pl-2">Nome Completo</label>
                            <input id="input-nome" required type="text" class="w-full bg-[#000814]/80 border border-blue-500/20 rounded-xl px-6 py-4 text-white focus:border-blue-500 outline-none transition-all placeholder:text-blue-900/30 font-sans" placeholder="Digite seu nome...">
                        </div>

                        <div id="registration-fields" class="space-y-8">
                            <div class="space-y-2">
                                <label class="text-[10px] font-sans font-bold text-blue-400 uppercase tracking-luxury pl-2">Contato (Email ou Whats)</label>
                                <input id="input-contato" required type="text" class="w-full bg-[#000814]/80 border border-blue-500/20 rounded-xl px-6 py-4 text-white focus:border-blue-500 outline-none transition-all placeholder:text-blue-900/30 font-sans" placeholder="Seu contato...">
                            </div>

                            <div class="py-6 border-y border-blue-500/10 space-y-6">
                                <p class="text-center text-xs font-bold uppercase tracking-widest text-blue-200/60">Você irá comparecer?</p>
                                <div class="grid grid-cols-2 gap-4">
                                    <button type="button" onclick="setAttendance(true)" id="btn-sim" class="py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 transition-all">SIM</button>
                                    <button type="button" onclick="setAttendance(false)" id="btn-nao" class="py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 transition-all">NÃO</button>
                                </div>
                            </div>

                            <div id="extra-fields" class="hidden space-y-6">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="text-[9px] font-bold text-blue-400 uppercase tracking-widest block mb-2 text-center">Adultos Extras</label>
                                        <div class="flex items-center justify-between bg-[#000814]/60 border border-blue-500/20 rounded-xl px-3 py-2">
                                            <button type="button" onclick="changeCount('adultos', -1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">-</button>
                                            <input id="input-adultos" type="number" min="0" value="0" readonly class="w-8 bg-transparent text-center text-white font-serif text-xl outline-none">
                                            <button type="button" onclick="changeCount('adultos', 1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">+</button>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="text-[9px] font-bold text-blue-400 uppercase tracking-widest block mb-2 text-center">Crianças</label>
                                        <div class="flex items-center justify-between bg-[#000814]/60 border border-blue-500/20 rounded-xl px-3 py-2">
                                            <button type="button" onclick="changeCount('criancas', -1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">-</button>
                                            <input id="input-criancas" type="number" min="0" value="0" readonly class="w-8 bg-transparent text-center text-white font-serif text-xl outline-none">
                                            <button type="button" onclick="changeCount('criancas', 1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">+</button>
                                        </div>
                                    </div>
                                </div>
                                <div id="companions-list" class="space-y-3"></div>
                            </div>
                        </div>

                        <button type="submit" id="btn-submit" class="w-full bg-white text-blue-950 py-5 rounded-xl font-bold uppercase tracking-widest text-xs hover:scale-[1.01] transition-all shadow-xl">
                            Confirmar
                        </button>

                        <div class="text-center mt-6">
                            <button type="button" id="toggle-login-btn" onclick="toggleLoginMode()" class="text-[10px] text-blue-400/60 hover:text-blue-400 uppercase tracking-widest font-bold transition-all underline underline-offset-4">
                                Já confirmei minha presença
                            </button>
                        </div>
                    </div>
                </form>
                
                <button onclick="toggleAdmin()" class="mt-16 text-[10px] text-blue-300/60 hover:text-white border border-blue-500/20 px-6 py-3 rounded-full uppercase tracking-[0.3em] font-bold transition-all hover:bg-blue-500/10 hover:border-blue-500/50">
                    Acesso restrito
                </button>
            </div>
        </div>

        <!-- TELA 2: NÃO COMPARECIMENTO -->
        <div id="not-attending-screen" class="hidden min-h-screen flex flex-col items-center justify-center text-center px-6 bg-navy-gradient">
            <div class="max-w-md w-full bg-[#001d3d]/60 p-12 rounded-[3rem] border border-blue-500/20 backdrop-blur-md shadow-2xl">
                <div class="mb-8 flex justify-center">
                    <div class="w-20 h-20 bg-red-500/10 rounded-full flex items-center justify-center border border-red-500/20">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 9.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
                <h2 class="text-4xl font-serif text-white mb-4">Que pena!</h2>
                <p class="text-blue-100/60 text-sm leading-relaxed mb-10">
                    Sentiremos sua falta nesse momento tão especial. Agradecemos por nos avisar!
                </p>
                
                <div class="space-y-4">
                    <button onclick="resetRSVP()" class="w-full bg-white text-blue-950 py-4 rounded-xl font-bold uppercase tracking-widest text-[10px] hover:scale-[1.02] transition-all shadow-xl">
                        Mudei de ideia, eu vou!
                    </button>
                    <button onclick="logout()" class="w-full bg-blue-900/20 text-white/40 py-4 rounded-xl font-bold uppercase tracking-widest text-[10px] hover:text-white transition-all">
                        Sair
                    </button>
                </div>
            </div>
            
            <button onclick="toggleAdmin()" class="mt-16 text-[10px] text-blue-300/60 hover:text-white border border-blue-500/20 px-6 py-3 rounded-full uppercase tracking-[0.3em] font-bold transition-all hover:bg-blue-500/10 hover:border-blue-500/50">
                Acesso restrito
            </button>
        </div>

        <!-- TELA 3: SITE PRINCIPAL -->
        <div id="main-site" class="hidden">
            <nav id="main-nav" class="sticky top-0 z-50 bg-[#000814]/95 backdrop-blur-md border-b border-blue-900/20 py-6 px-6 transition-all duration-500">
                <div class="max-w-6xl mx-auto flex flex-col gap-6 transition-all duration-500" id="nav-container">
                    <!-- Top Row: Logo and Logout Icon -->
                    <div class="flex justify-between items-center">
                        <img src="https://i.imgur.com/tlyqJn0.png" alt="Logo MV" class="h-12 md:h-16 drop-shadow-[0_0_10px_rgba(59,130,246,0.3)] transition-all duration-500" id="nav-logo">
                        
                        <button onclick="logout()" class="text-red-400/60 hover:text-red-400 transition-colors p-2" title="Sair">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Bottom Row: Navigation Links (Side by Side) -->
                    <div class="flex justify-center items-center gap-x-5 text-[10px] font-bold uppercase tracking-[0.2em]">
                        <a href="#home" class="text-blue-400 hover:text-blue-300 transition-colors">Contagem</a>
                        <a href="#minha-presenca" class="text-white/60 hover:text-white transition-colors">Presença</a>
                        <a href="#evento" class="text-white/60 hover:text-white transition-colors">Evento</a>
                        <a href="#local" class="text-white/60 hover:text-white transition-colors">Local</a>
                    </div>
                </div>
            </nav>

            <section id="home" class="min-h-screen flex flex-col items-center justify-center text-center px-6 bg-navy-gradient">
                <h1 class="text-4xl md:text-7xl font-serif text-white mb-4">Presença Confirmada!</h1>
                <p class="text-blue-400/60 font-sans text-xs uppercase tracking-ultra font-bold mb-10">Contagem Regressiva</p>
                <div class="grid grid-cols-4 gap-4 md:gap-8 mb-12">
                    <div class="bg-blue-900/20 p-4 rounded-2xl border border-blue-500/20 w-16 md:w-24 aspect-square flex flex-col items-center justify-center">
                        <span id="days" class="text-2xl md:text-4xl font-serif">00</span>
                        <span class="text-[8px] uppercase">Dias</span>
                    </div>
                    <div class="bg-blue-900/20 p-4 rounded-2xl border border-blue-500/20 w-16 md:w-24 aspect-square flex flex-col items-center justify-center">
                        <span id="hours" class="text-2xl md:text-4xl font-serif">00</span>
                        <span class="text-[8px] uppercase">Horas</span>
                    </div>
                    <div class="bg-blue-900/20 p-4 rounded-2xl border border-blue-500/20 w-16 md:w-24 aspect-square flex flex-col items-center justify-center">
                        <span id="mins" class="text-2xl md:text-4xl font-serif">00</span>
                        <span class="text-[8px] uppercase">Min</span>
                    </div>
                    <div class="bg-blue-900/20 p-4 rounded-2xl border border-blue-500/20 w-16 md:w-24 aspect-square flex flex-col items-center justify-center">
                        <span id="secs" class="text-2xl md:text-4xl font-serif">00</span>
                        <span class="text-[8px] uppercase">Seg</span>
                    </div>
                </div>
            </section>

            <section id="minha-presenca" class="py-12 px-6 bg-[#00040a]">
                    <div class="bg-[#001d3d]/40 p-8 rounded-3xl border border-blue-500/20 max-w-md w-full text-left mx-auto relative group">
                        <button onclick="editRSVP()" class="absolute top-4 right-4 bg-blue-500/20 hover:bg-blue-500/40 p-2 rounded-lg text-[10px] uppercase font-bold tracking-widest flex items-center gap-2 transition-all">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                            </svg>
                            Editar
                        </button>
                        <h3 id="user-name-display" class="text-2xl font-serif mb-2">Convidado</h3>
                        <p class="text-blue-400 text-xs uppercase tracking-widest mb-6">Status: Confirmado</p>
                        <div class="grid grid-cols-2 gap-4 text-center mb-6">
                            <div class="bg-blue-950/50 p-4 rounded-xl">
                                <span id="user-adults-display" class="block text-2xl font-serif">0</span>
                                <span class="text-[8px] uppercase text-white/40">Adultos</span>
                            </div>
                            <div class="bg-blue-950/50 p-4 rounded-xl">
                                <span id="user-children-display" class="block text-2xl font-serif">0</span>
                                <span class="text-[8px] uppercase text-white/40">Crianças</span>
                            </div>
                        </div>
                        <div id="user-companions-container" class="hidden border-t border-blue-500/10 pt-6">
                            <p class="text-[10px] font-bold text-blue-400 uppercase tracking-widest mb-3">Acompanhantes:</p>
                            <div id="user-companions-display" class="flex flex-wrap gap-2"></div>
                        </div>
                    </div>
            </section>

            <section id="evento" class="py-12 px-6 bg-[#00040a]">
                <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-12 items-center">
                    <div class="space-y-8">
                        <div class="p-8 bg-blue-900/10 rounded-3xl border border-blue-500/10">
                            <h3 class="text-2xl font-serif mb-2">21 de Março</h3>
                            <p class="text-blue-400 text-xs uppercase tracking-widest">Sábado • 20:30h</p>
                        </div>
                        <div class="p-8 bg-blue-900/10 rounded-3xl border border-blue-500/10">
                            <h3 class="text-2xl font-serif mb-2">Clube Comercial</h3>
                            <p class="text-blue-400 text-xs uppercase tracking-widest">Catuípe • RS</p>
                        </div>
                    </div>
                    <div class="h-[400px] bg-blue-900/20 rounded-[3rem] overflow-hidden relative group">
                        <img id="carousel-img" src="https://i.imgur.com/obTc9mr.jpeg" class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition-all duration-700" alt="Foto 1" style="transition: opacity 0.5s ease-in-out;">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent p-8 flex flex-col justify-end">
                            <h4 class="text-xl md:text-2xl font-sans font-light uppercase tracking-[0.4em] text-white mb-2 opacity-90">Maria Valentina</h4>
                            <p class="text-blue-300/50 text-[10px] uppercase tracking-widest font-sans">Bacharel em Psicologia</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="local" class="py-12 px-6 bg-[#000814]">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-4xl font-serif mb-10">Localização</h2>
                    <div class="h-[400px] rounded-[3rem] overflow-hidden border border-blue-500/20 relative">
                        <iframe 
                            src="https://maps.google.com/maps?q=Clube+Comercial+Catuípe+RS&t=&z=17&ie=UTF8&iwloc=&output=embed" 
                            width="100%" height="100%" 
                            style="border:0; filter: invert(90%) hue-rotate(180deg) brightness(0.9) contrast(1.2);" 
                            allowfullscreen="" loading="lazy">
                        </iframe>
                        <a href="https://www.google.com/maps/dir/?api=1&destination=Clube+Comercial+Catuípe+RS" target="_blank" class="absolute bottom-6 left-1/2 -translate-x-1/2 bg-blue-600 text-white px-8 py-3 rounded-full text-xs font-bold uppercase tracking-widest shadow-xl hover:bg-blue-500 transition-colors">
                            Traçar Rota
                        </a>
                    </div>
                </div>
            </section>

            <!-- Footer com Acesso Restrito e Créditos -->
            <footer class="py-20 flex flex-col items-center bg-[#000814] border-t border-blue-900/10 px-6 text-center">
                <!-- Logo Apagada -->
                <img src="https://i.imgur.com/tlyqJn0.png" alt="Logo MV" class="h-20 md:h-32 opacity-15 mb-8 grayscale pointer-events-none">
                
                <!-- Frase -->
                <p class="text-[11px] md:text-xs text-blue-100/40 font-sans font-light max-w-lg mb-12 italic leading-relaxed">
                    "Conheça todas as teorias, domine todas as técnicas, mas ao tocar uma alma humana, seja apenas outra alma humana"
                </p>

                <button onclick="toggleAdmin()" class="text-[10px] text-blue-300/40 hover:text-white border border-blue-500/10 px-8 py-3 rounded-full uppercase tracking-[0.3em] font-bold transition-all hover:bg-blue-500/10 hover:border-blue-500/30 mb-16">
                    Acesso restrito
                </button>

                <!-- Créditos -->
                <div class="space-y-1">
                    <p class="text-[9px] uppercase tracking-[0.2em] text-white/20">Site desenvolvido por Igor A. Londero</p>
                    <a href="https://instagram.com/igorlondero1" target="_blank" class="text-[9px] tracking-[0.1em] text-blue-400/40 hover:text-blue-400 transition-colors">@igorlondero1</a>
                </div>
            </footer>
        </div>

        <!-- MODAL ADMIN -->
        <div id="admin-modal" class="hidden fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex items-center justify-center p-4 md:p-6">
            <div class="w-full max-w-md bg-[#001d3d] border border-blue-500/30 p-6 md:p-10 rounded-[2.5rem] relative shadow-[0_0_50px_rgba(30,58,138,0.3)] max-h-[90vh] overflow-y-auto custom-scrollbar">
                <button onclick="toggleAdmin()" class="absolute top-6 right-6 text-white/40 hover:text-white transition-colors z-20">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                
                <div id="admin-login-view">
                    <h2 class="text-3xl font-serif mb-2 text-center text-white">Acesso Restrito</h2>
                    <p class="text-blue-400/60 text-[10px] uppercase tracking-widest text-center mb-8 font-bold">Área do Organizador</p>
                    
                    <div class="space-y-4">
                        <input id="admin-pass" type="password" placeholder="Digite a senha de acesso" class="w-full bg-black/40 border border-blue-500/20 rounded-2xl px-6 py-4 text-white outline-none focus:border-blue-500 transition-all text-center">
                        <button onclick="checkAdmin()" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-2xl font-bold uppercase text-xs tracking-widest transition-all shadow-lg">Entrar</button>
                        <p id="admin-error" class="text-red-400 text-[10px] text-center mt-2 hidden uppercase font-bold tracking-widest">Senha incorreta</p>
                    </div>
                </div>
                
                <div id="admin-content" class="hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-serif text-white">Lista de Convidados</h2>
                        <button onclick="loadGuestList()" class="text-blue-400 text-[10px] uppercase font-bold tracking-widest hover:text-blue-300 transition-colors">Atualizar</button>
                    </div>

                    <!-- Totais -->
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-blue-950/40 border border-blue-500/10 p-4 rounded-2xl text-center">
                            <span id="total-adults" class="block text-2xl font-serif text-white">0</span>
                            <span class="text-[8px] uppercase text-blue-400 font-bold tracking-widest">Total Adultos</span>
                        </div>
                        <div class="bg-blue-950/40 border border-blue-500/10 p-4 rounded-2xl text-center">
                            <span id="total-children" class="block text-2xl font-serif text-white">0</span>
                            <span class="text-[8px] uppercase text-blue-400 font-bold tracking-widest">Total Crianças</span>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto no-scrollbar max-h-[400px] overflow-y-auto pr-2">
                        <table class="w-full text-left text-[10px] uppercase tracking-wider">
                            <thead class="sticky top-0 bg-[#001d3d] text-blue-400 font-bold border-b border-blue-500/20 z-10">
                                <tr>
                                    <th class="py-4 px-3">Nome</th>
                                    <th class="py-4 px-3">Status</th>
                                    <th class="py-4 px-3">Acomp.</th>
                                </tr>
                            </thead>
                            <tbody id="guest-list-body" class="divide-y divide-blue-500/10">
                                <tr><td colspan="3" class="py-12 text-center text-white/40 italic">Carregando convidados...</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="mt-8 pt-6 border-t border-white/10">
                        <a href="https://docs.google.com/spreadsheets/d/1GPPD4VvLTwxDnANE_X7QB5UIZHfdNusx0EEsHiJKq_w/edit" target="_blank" class="flex items-center justify-center gap-2 w-full bg-green-600/10 hover:bg-green-600/20 text-green-400 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-widest transition-all border border-green-500/20">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                            </svg>
                            Abrir Planilha Completa
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyj_2LEKaOZ-DlXaUc27wyC041kVADQpWWjbb1MMwfw9jOceIZjyyIYJSuVTTJpr4Kb0Q/exec';
        const EVENT_DATE = new Date('2026-03-21T20:30:00').getTime();
        const carouselImages = ["https://i.imgur.com/obTc9mr.jpeg", "https://i.imgur.com/68Ba0yL.jpeg", "https://i.imgur.com/yKIKYgX.jpeg"];
        let currentImageIndex = 0;
        let isAttending = null;
        let isLoginMode = false;
        let isEditingMode = false;

        function toggleLoginMode() {
            isLoginMode = !isLoginMode;
            const regFields = document.getElementById('registration-fields');
            const toggleBtn = document.getElementById('toggle-login-btn');
            const submitBtn = document.getElementById('btn-submit');
            const formTitle = document.getElementById('form-title');
            const contatoInput = document.getElementById('input-contato');

            if (isLoginMode) {
                regFields.classList.add('hidden');
                contatoInput.required = false;
                toggleBtn.innerText = 'Quero me registrar';
                submitBtn.innerText = 'Entrar';
                formTitle.innerText = 'Acessar Convite';
            } else {
                regFields.classList.remove('hidden');
                contatoInput.required = true;
                toggleBtn.innerText = 'Já confirmei minha presença';
                submitBtn.innerText = 'Confirmar';
                formTitle.innerText = 'Registro de Presença';
            }
        }

        window.onload = function() {
            try {
                const savedData = localStorage.getItem('graduation_rsvp');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    if (data.comparecera === 'Sim') {
                        showMainSite(data);
                    } else {
                        showNotAttendingScreen();
                    }
                }
            } catch (e) { localStorage.removeItem('graduation_rsvp'); }
            startCountdown();
            startCarousel();
            initScrollEffect();
        };

        function showNotAttendingScreen() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('main-site').classList.add('hidden');
            document.getElementById('not-attending-screen').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function resetRSVP() {
            document.getElementById('not-attending-screen').classList.add('hidden');
            document.getElementById('welcome-screen').classList.remove('hidden');
            
            // Se houver dados salvos, preenche o nome e contato para facilitar
            const savedData = localStorage.getItem('graduation_rsvp');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('input-nome').value = data.nome || '';
                document.getElementById('input-contato').value = data.contato || '';
            }
            
            setAttendance(null);
            document.getElementById('rsvp-section').scrollIntoView({behavior: 'smooth'});
        }

        function initScrollEffect() {
            const nav = document.getElementById('main-nav');
            const container = document.getElementById('nav-container');
            const logo = document.getElementById('nav-logo');
            const navLinks = document.querySelectorAll('#main-nav a[href^="#"]');
            const sections = Array.from(navLinks).map(link => document.getElementById(link.getAttribute('href').substring(1)));

            const updateNav = () => {
                // Efeito de encolher
                if (window.scrollY > 50) {
                    nav.classList.add('py-3');
                    nav.classList.remove('py-6');
                    container.classList.remove('gap-6');
                    container.classList.add('gap-2');
                    logo.classList.add('h-8');
                    logo.classList.remove('h-12', 'md:h-16');
                } else {
                    nav.classList.add('py-6');
                    nav.classList.remove('py-3');
                    container.classList.add('gap-6');
                    container.classList.remove('gap-2');
                    logo.classList.remove('h-8');
                    logo.classList.add('h-12', 'md:h-16');
                }

                // Lógica do Scroll Spy
                const scrollPosition = window.scrollY + window.innerHeight / 2;
                let currentSectionId = '';

                sections.forEach(section => {
                    if (section && scrollPosition >= section.offsetTop && scrollPosition < section.offsetTop + section.offsetHeight) {
                        currentSectionId = section.id;
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('text-blue-400');
                    link.classList.add('text-white/60');
                    if (link.getAttribute('href') === `#${currentSectionId}`) {
                        link.classList.add('text-blue-400');
                        link.classList.remove('text-white/60');
                    }
                });
            };

            window.addEventListener('scroll', updateNav);
            updateNav(); // Executa uma vez no carregamento
        }

        function startCarousel() {
            const img = document.getElementById('carousel-img');
            if (!img) return;
            setInterval(() => {
                currentImageIndex = (currentImageIndex + 1) % carouselImages.length;
                img.style.opacity = 0;
                setTimeout(() => {
                    img.src = carouselImages[currentImageIndex];
                    img.style.opacity = 0.8;
                }, 500);
            }, 4000);
        }

        function startCountdown() {
            setInterval(() => {
                const distance = EVENT_DATE - new Date().getTime();
                if (distance < 0) return;
                document.getElementById('days').innerText = Math.floor(distance / 86400000).toString().padStart(2, '0');
                document.getElementById('hours').innerText = Math.floor((distance % 86400000) / 3600000).toString().padStart(2, '0');
                document.getElementById('mins').innerText = Math.floor((distance % 3600000) / 60000).toString().padStart(2, '0');
                document.getElementById('secs').innerText = Math.floor((distance % 60000) / 1000).toString().padStart(2, '0');
            }, 1000);
        }

        function changeCount(id, delta) {
            const input = document.getElementById('input-' + id);
            input.value = Math.max(0, (parseInt(input.value) || 0) + delta);
            updateCompanionsList();
        }

        function updateCompanionsList() {
            const adults = parseInt(document.getElementById('input-adultos').value) || 0;
            const children = parseInt(document.getElementById('input-criancas').value) || 0;
            const container = document.getElementById('companions-list');
            container.innerHTML = '';
            if (adults > 0 || children > 0) {
                const label = document.createElement('label');
                label.className = 'text-[9px] font-bold text-blue-400 uppercase tracking-widest block pl-2';
                label.innerText = 'Nomes dos Acompanhantes';
                container.appendChild(label);
                for (let i = 0; i < adults; i++) createInput(container, `Nome do Adulto ${i + 1}`);
                for (let i = 0; i < children; i++) createInput(container, `Nome da Criança ${i + 1}`);
            }
        }

        function createInput(container, placeholder) {
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'w-full bg-[#000814]/60 border border-blue-500/20 rounded-xl px-4 py-3 text-white text-sm companion-name-input';
            input.placeholder = placeholder;
            container.appendChild(input);
        }

        function setAttendance(val) {
            isAttending = val;
            document.getElementById('btn-sim').className = val ? 'py-4 rounded-xl border border-blue-400 bg-blue-600 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50';
            document.getElementById('btn-nao').className = !val ? 'py-4 rounded-xl border border-red-400 bg-red-900/50 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50';
            document.getElementById('extra-fields').classList.toggle('hidden', !val);
        }

        async function handleRSVPSubmit(e) {
            const isUpdateFlow = isEditingMode; // Captura o estado de edição
            isEditingMode = false; // Reseta o estado para o próximo envio
            e.preventDefault();
            const nomeRaw = document.getElementById('input-nome').value;
            const nome = nomeRaw.trim();
            const btn = document.getElementById('btn-submit');
            const originalText = isLoginMode ? 'Entrar' : 'Confirmar';
            
            btn.innerText = 'Verificando...'; 
            btn.disabled = true;

            const normalize = (str) => str ? str.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim() : "";
            const nomeNormalizado = normalize(nome);

            try {
                // 1. BUSCA PRÉVIA
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 8000); 

                let existingGuest = null;
                try {
                    const cacheBuster = Date.now();
                    const responseRead = await fetch(`${GOOGLE_SCRIPT_URL}?action=read&_=${cacheBuster}`, { signal: controller.signal });
                    const guests = await responseRead.json();
                    existingGuest = guests.find(g => normalize(g.nome) === nomeNormalizado);
                } catch (readErr) {
                    console.warn('Falha na leitura, prosseguindo com tentativa de registro...');
                }
                clearTimeout(timeoutId);

                // 2. LÓGICA DE LOGIN VS ATUALIZAÇÃO
                if (existingGuest) {
                    if (isLoginMode) {
                        // MODO LOGIN: Entra direto
                        btn.innerText = 'Entrando...';
                        const userData = {
                            nome: existingGuest.nome,
                            contato: existingGuest.contato,
                            comparecera: existingGuest.comparecera,
                            adultos: existingGuest.adultos,
                            criancas: existingGuest.criancas,
                            acompanhantes: existingGuest.acompanhantes
                        };
                        localStorage.setItem('graduation_rsvp', JSON.stringify(userData));
                        setTimeout(() => {
                            if (userData.comparecera === 'Sim') showMainSite(userData);
                            else showNotAttendingScreen();
                        }, 500);
                        return;
                    } else if (!isUpdateFlow) {
                        // É um novo registro com nome duplicado, então bloqueia e sugere login
                        alert('Este nome já possui um registro. Por favor, acesse a área de login para entrar ou editar seus dados.');
                        toggleLoginMode();
                        btn.innerText = 'Entrar';
                        btn.disabled = false;
                        return;
                    }
                    // Se for um fluxo de atualização (isUpdateFlow = true), o código simplesmente continua para a seção de POST abaixo.
                }

                // 3. REGISTRO / ATUALIZAÇÃO (POST)
                if (!isLoginMode && isAttending === null) {
                    alert('Selecione SIM ou NÃO.');
                    btn.innerText = originalText;
                    btn.disabled = false;
                    return;
                }

                // Validação dos nomes dos acompanhantes
                const companionInputs = document.querySelectorAll('.companion-name-input');
                if (Array.from(companionInputs).some(input => input.value.trim() === '')) {
                    alert('Por favor, preencha o nome de todos os acompanhantes.');
                    btn.disabled = false;
                    btn.innerText = originalText;
                    return;
                }

                btn.innerText = 'Salvando...';
                const names = Array.from(document.querySelectorAll('.companion-name-input')).map(i => i.value).filter(n => n.trim() !== '');
                const data = {
                    action: 'upsert', 
                    nome: nome, 
                    contato: document.getElementById('input-contato').value,
                    comparecera: isAttending ? 'Sim' : 'Não', 
                    adultos: isAttending ? (parseInt(document.getElementById('input-adultos').value) + 1).toString() : '0',
                    criancas: document.getElementById('input-criancas').value, 
                    acompanhantes: names.join(', ') || 'Nenhum',
                    data_hora: new Date().toLocaleString('pt-BR')
                };

                try {
                    await fetch(GOOGLE_SCRIPT_URL, { 
                        method: 'POST', 
                        mode: 'no-cors', 
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify(data)
                    });
                } catch (err) {
                    console.warn("Falha no envio para a planilha, mas salvo localmente.", err);
                }

                // A lógica de UI continua inalterada, garantindo que sempre execute
                localStorage.setItem('graduation_rsvp', JSON.stringify(data));
                btn.innerText = 'Sucesso!';

                setTimeout(() => {
                    if (data.comparecera === 'Sim') {
                        showMainSite(data);
                    } else {
                        showNotAttendingScreen();
                    }

                    // Reseta o formulário para um novo registro
                    btn.disabled = false;
                    btn.innerText = originalText;
                    document.getElementById('rsvp-form').reset();
                    setAttendance(null);
                    updateCompanionsList();
                    isEditingMode = false;
                }, 800);


            } catch (err) {
                console.error('Erro Geral:', err);
                btn.disabled = false;
                btn.innerText = originalText;
                alert('Ocorreu um erro de conexão. Por favor, tente novamente.');
            }
        }

        function showNotAttendingScreen() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('main-site').classList.add('hidden');
            document.getElementById('not-attending-screen').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function resetRSVP() {
            isEditingMode = true; // Trata a ação como uma atualização
            
            // Troca as telas
            document.getElementById('not-attending-screen').classList.add('hidden');
            document.getElementById('main-site').classList.add('hidden');
            document.getElementById('welcome-screen').classList.remove('hidden');

            // Preenche o formulário com os dados salvos para facilitar
            const savedData = localStorage.getItem('graduation_rsvp');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('input-nome').value = data.nome || '';
                document.getElementById('input-contato').value = data.contato || '';
            }
            
            // Reseta a seleção de presença
            setAttendance(null);
            
            // Rola para o formulário
            document.getElementById('rsvp-section').scrollIntoView({ behavior: 'smooth' });
        }

        function editRSVP() {
            const savedData = localStorage.getItem('graduation_rsvp');
            if (!savedData) return;
            const data = JSON.parse(savedData);
            
            toggleEditModal(true);

            const editForm = document.getElementById('edit-form');
            isEditAttending = data.comparecera === 'Sim';
            const isSim = data.comparecera === 'Sim';

            editForm.onsubmit = async (e) => {
                e.preventDefault();

                // Validação dos nomes dos acompanhantes
                const companionInputs = document.querySelectorAll('.companion-name-input-edit');
                if (Array.from(companionInputs).some(input => input.value.trim() === '')) {
                    alert('Por favor, preencha o nome de todos os acompanhantes.');
                    return; // Impede o envio do formulário
                }

                const btn = editForm.querySelector('button[type="submit"]');
                btn.innerText = 'Salvando...';
                btn.disabled = true;

                const savedData = JSON.parse(localStorage.getItem('graduation_rsvp'));

                const names = Array.from(document.querySelectorAll('.companion-name-input-edit')).map(i => i.value).filter(n => n.trim() !== '');
                const updatedData = {
                    action: 'upsert',
                    nome: savedData.nome,
                    contato: savedData.contato,
                    comparecera: isEditAttending ? 'Sim' : 'Não',
                    adultos: isEditAttending ? (parseInt(document.getElementById('edit-input-adultos').value) + 1).toString() : '0',
                    criancas: document.getElementById('edit-input-criancas').value,
                    acompanhantes: names.join(', ') || 'Nenhum',
                    data_hora: new Date().toLocaleString('pt-BR')
                };

                try {
                    await fetch(GOOGLE_SCRIPT_URL, { 
                        method: 'POST', 
                        mode: 'no-cors', 
                        headers: { 'Content-Type': 'text/plain' },
                        body: JSON.stringify(updatedData)
                    });
                } catch (err) {
                    console.warn("Falha ao salvar na planilha, mas atualizando localmente.", err);
                }

                localStorage.setItem('graduation_rsvp', JSON.stringify(updatedData));
                btn.innerText = 'Salvo!';
                
                setTimeout(() => {
                    toggleEditModal(false);
                    location.reload();
                }, 800);
            };

            editForm.innerHTML = `
                <div class="mb-6">
                    <p class="text-center text-blue-200/60 mb-4">Você irá comparecer?</p>
                    <div class="grid grid-cols-2 gap-4">
                        <button type="button" id="edit-btn-sim" onclick="setEditAttendance(true)" class="${isSim ? 'py-4 rounded-xl border border-blue-400 bg-blue-600 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50'}">Sim</button>
                        <button type="button" id="edit-btn-nao" onclick="setEditAttendance(false)" class="${!isSim ? 'py-4 rounded-xl border border-red-400 bg-red-900/50 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50'}">Não</button>
                    </div>
                </div>
                <div id="edit-extra-fields" class="${isSim ? '' : 'hidden'}">
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="text-xs text-blue-200/50 block mb-2 text-center">Adultos (além de você)</label>
                            <div class="flex items-center justify-between bg-blue-950/40 border border-blue-500/30 rounded-lg px-3 py-2">
                                <button type="button" onclick="changeEditCount('adultos', -1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">-</button>
                                <input id="edit-input-adultos" type="number" min="0" value="${Math.max(0, (parseInt(data.adultos) || 1) - 1)}" readonly class="w-8 bg-transparent text-center text-white font-serif text-xl outline-none">
                                <button type="button" onclick="changeEditCount('adultos', 1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">+</button>
                            </div>
                        </div>
                        <div>
                            <label class="text-xs text-blue-200/50 block mb-2 text-center">Crianças (0-10 anos)</label>
                            <div class="flex items-center justify-between bg-blue-950/40 border border-blue-500/30 rounded-lg px-3 py-2">
                                <button type="button" onclick="changeEditCount('criancas', -1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">-</button>
                                <input id="edit-input-criancas" type="number" min="0" value="${data.criancas || 0}" readonly class="w-8 bg-transparent text-center text-white font-serif text-xl outline-none">
                                <button type="button" onclick="changeEditCount('criancas', 1)" class="text-blue-400 text-lg font-bold w-8 h-8 flex items-center justify-center hover:bg-blue-500/10 rounded-lg">+</button>
                            </div>
                        </div>
                    </div>
                    <div id="edit-companions-list" class="space-y-2">
                        <!-- Companion inputs will be generated here -->
                    </div>
                </div>
                <div class="mt-8 flex justify-end gap-4">
                    <button type="button" onclick="toggleEditModal(false)" class="bg-gray-700/50 text-white/60 px-6 py-3 rounded-lg text-sm font-bold hover:bg-gray-700/80">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg text-sm font-bold hover:bg-blue-500">Salvar Alterações</button>
                </div>
            `;
            
            const allNames = (data.acompanhantes && data.acompanhantes !== 'Nenhum') ? data.acompanhantes.split(', ') : [];
            const adultCompanionsCount = Math.max(0, (parseInt(data.adultos) || 1) - 1);
            const initialAdultNames = allNames.slice(0, adultCompanionsCount);
            const initialChildNames = allNames.slice(adultCompanionsCount);
            updateEditCompanionsList(initialAdultNames, initialChildNames);
        }

        function logout() { localStorage.removeItem('graduation_rsvp'); location.reload(); }
        function toggleAdmin() { document.getElementById('admin-modal').classList.toggle('hidden'); }
        function toggleEditModal(show) {
            document.getElementById('edit-modal').classList.toggle('hidden', !show);
        }

        let isEditAttending = null;
        function setEditAttendance(val) {
            isEditAttending = val;
            document.getElementById('edit-btn-sim').className = val ? 'py-4 rounded-xl border border-blue-400 bg-blue-600 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50';
            document.getElementById('edit-btn-nao').className = !val ? 'py-4 rounded-xl border border-red-400 bg-red-900/50 text-white font-bold uppercase text-xs shadow-lg' : 'py-4 rounded-xl border border-blue-500/20 font-bold uppercase text-xs hover:bg-blue-500/10 text-white/50';
            document.getElementById('edit-extra-fields').classList.toggle('hidden', !val);
            if (val) {
                updateEditCompanionsList();
            }
        }
        function changeEditCount(id, delta) {
            const input = document.getElementById('edit-input-' + id);
            if (!input) return;
            input.value = Math.max(0, (parseInt(input.value) || 0) + delta);
            updateEditCompanionsList();
        }

        function updateEditCompanionsList(initialAdultNames = [], initialChildNames = []) {
            const adults = parseInt(document.getElementById('edit-input-adultos').value) || 0;
            const children = parseInt(document.getElementById('edit-input-criancas').value) || 0;
            const container = document.getElementById('edit-companions-list');
            if (!container) return;

            // Preserve existing values by type
            const existingAdultInputs = container.querySelectorAll('.companion-name-input-edit[data-type="adult"]');
            const existingChildInputs = container.querySelectorAll('.companion-name-input-edit[data-type="child"]');
            
            const adultValues = existingAdultInputs.length > 0 ? Array.from(existingAdultInputs).map(input => input.value) : initialAdultNames;
            const childValues = existingChildInputs.length > 0 ? Array.from(existingChildInputs).map(input => input.value) : initialChildNames;

            container.innerHTML = '';

            if (adults > 0) {
                const label = document.createElement('label');
                label.className = 'text-xs text-blue-200/50 block mb-2';
                label.innerText = 'Nome dos acompanhantes adultos';
                container.appendChild(label);

                for (let i = 0; i < adults; i++) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.dataset.type = 'adult';
                    input.className = 'companion-name-input-edit w-full bg-blue-950/40 border border-blue-500/30 rounded-lg px-4 py-3 text-white placeholder-white/30 text-sm mb-2';
                    input.placeholder = `Acompanhante Adulto ${i + 1}`;
                    input.value = adultValues[i] || '';
                    container.appendChild(input);
                }
            }

            if (children > 0) {
                const label = document.createElement('label');
                label.className = 'text-xs text-blue-200/50 block mb-2 mt-4';
                label.innerText = 'Nome das crianças acompanhantes';
                container.appendChild(label);

                for (let i = 0; i < children; i++) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.dataset.type = 'child';
                    input.className = 'companion-name-input-edit w-full bg-blue-950/40 border border-blue-500/30 rounded-lg px-4 py-3 text-white placeholder-white/30 text-sm mb-2';
                    input.placeholder = `Criança ${i + 1}`;
                    input.value = childValues[i] || '';
                    container.appendChild(input);
                }
            }
        }

        function checkAdmin() {
            const pass = document.getElementById('admin-pass').value;
            if (btoa(pass) === 'dmFsZW50aW5hMjAyNg==') {
                document.getElementById('admin-content').classList.remove('hidden');
                document.getElementById('admin-login-view').classList.add('hidden');
                // Aumentar o modal para a lista
                document.querySelector('#admin-modal > div').classList.replace('max-w-md', 'max-w-2xl');
                loadGuestList();
            } else document.getElementById('admin-error').classList.remove('hidden');
        }

        function showMainSite(data) {
            try {
                const welcomeScreen = document.getElementById('welcome-screen');
                const notAttendingScreen = document.getElementById('not-attending-screen');
                const mainSite = document.getElementById('main-site');
                const userName = document.getElementById('user-name-display');
                const userAdults = document.getElementById('user-adults-display');
                const userChildren = document.getElementById('user-children-display');
                const companionsContainer = document.getElementById('user-companions-container');
                const companionsDisplay = document.getElementById('user-companions-display');

                if (!welcomeScreen || !notAttendingScreen || !mainSite || !userName || !userAdults || !userChildren || !companionsContainer || !companionsDisplay) {
                    console.error("Um ou mais elementos da UI principal não foram encontrados.");
                    alert("Erro ao carregar a página de confirmação. Por favor, recarregue.");
                    return;
                }

                welcomeScreen.classList.add('hidden');
                notAttendingScreen.classList.add('hidden');
                mainSite.classList.remove('hidden');

                userName.innerText = data.nome || 'Convidado';
                userAdults.innerText = data.adultos || 1;
                userChildren.innerText = data.criancas || 0;

                if (data.acompanhantes && data.acompanhantes !== 'Nenhum') {
                    companionsContainer.classList.remove('hidden');
                    companionsDisplay.innerHTML = '';
                    data.acompanhantes.split(', ').forEach(name => {
                        const span = document.createElement('span');
                        span.className = 'bg-blue-500/10 border border-blue-500/20 px-3 py-1 rounded-full text-[10px] text-white/80 italic';
                        span.innerText = name;
                        companionsDisplay.appendChild(span);
                    });
                } else {
                    companionsContainer.classList.add('hidden');
                }

                window.scrollTo(0, 0);
            } catch (err) {
                console.error("Erro dentro de showMainSite:", err);
                alert("Ocorreu um erro inesperado ao exibir sua confirmação.");
            }
        }

        async function loadGuestList() {
            const body = document.getElementById('guest-list-body');
            body.innerHTML = '<tr><td colspan="3" class="py-12 text-center text-white/40 italic">Buscando dados na planilha...</td></tr>';
            
            try {
                // Tenta buscar via GET (mais estável para leitura no Apps Script)
                const response = await fetch(GOOGLE_SCRIPT_URL + '?action=read');
                const textResponse = await response.text();
                
                let data = [];
                try {
                    data = JSON.parse(textResponse);
                } catch (e) {
                    if (textResponse.includes('Conectado')) {
                        data = [];
                    } else {
                        throw new Error('Dados inválidos recebidos da planilha');
                    }
                }
                
                body.innerHTML = '';
                if (!data || data.length === 0) {
                    body.innerHTML = '<tr><td colspan="3" class="py-12 text-center text-white/40">Nenhum registro encontrado.</td></tr>';
                    return;
                }

                let totalAdults = 0;
                let totalChildren = 0;

                data.forEach(guest => {
                    const adults = parseInt(guest.adultos) || 0;
                    const children = parseInt(guest.criancas) || 0;
                    
                    if (guest.comparecera === 'Sim') {
                        totalAdults += adults;
                        totalChildren += children;
                    }

                    const tr = document.createElement('tr');
                    tr.className = 'hover:bg-blue-500/5 transition-colors';
                    tr.innerHTML = `
                        <td class="py-4 px-3 font-medium text-white">
                            ${guest.nome}
                            <span class="block text-[8px] text-blue-400/50 lowercase">${guest.contato}</span>
                        </td>
                        <td class="py-4 px-3 ${guest.comparecera === 'Sim' ? 'text-green-400' : 'text-red-400'}">${guest.comparecera}</td>
                        <td class="py-4 px-3 text-white/60 text-[9px]">
                            <div class="flex flex-col gap-1">
                                <span class="text-white/80">${adults} Ad. / ${children} Cri.</span>
                                <span class="italic text-[8px] truncate max-w-[100px]">${guest.acompanhantes || 'Nenhum'}</span>
                            </div>
                        </td>
                    `;
                    body.appendChild(tr);
                });

                // Atualiza os elementos de total na tela
                const totalAdultsEl = document.getElementById('total-adults');
                const totalChildrenEl = document.getElementById('total-children');
                if (totalAdultsEl) totalAdultsEl.innerText = totalAdults;
                if (totalChildrenEl) totalChildrenEl.innerText = totalChildren;

            } catch (error) {
                console.error(error);
                body.innerHTML = '<tr><td colspan="3" class="py-12 text-center text-red-400/60">Erro ao carregar. Verifique se a planilha está pública.</td></tr>';
            }
        }
    </script>

    <!-- MODAL DE EDIÇÃO DE PRESENÇA -->
    <div id="edit-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-[#001d3d] max-w-lg w-full rounded-3xl border border-blue-500/20 shadow-2xl p-8 relative max-h-[90vh] overflow-y-auto no-scrollbar">
            <button onclick="toggleEditModal(false)" class="absolute top-4 right-4 w-8 h-8 rounded-full bg-blue-900/30 text-white/40 hover:bg-blue-800/50 hover:text-white transition-all flex items-center justify-center">&times;</button>
            <h3 class="text-3xl font-serif text-white mb-6 text-center">Editar Minha Presença</h3>
            
            <form id="edit-form">
                <!-- Conteúdo do formulário de edição virá aqui -->
                <div class="text-center text-blue-200/40 italic py-10">
                    (Carregando seus dados...)
                </div>
            </form>
        </div>
    </div>
</body>
</html>
